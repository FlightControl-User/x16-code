<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Equinoxe: equinoxe-floorengine.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Equinoxe
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">equinoxe-floorengine.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="equinoxe-floorengine_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Space tile scrolling engine for a space game written in kickc for the Commander X16.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#pragma var_model(mem)</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cx16_8h.html">cx16.h</a>&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cx16-veralib_8h.html">cx16-veralib.h</a>&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cx16-heap_8h.html">cx16-heap.h</a>&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="kernal_8h.html">kernal.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="6502_8h.html">6502.h</a>&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="conio_8h.html">conio.h</a>&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cx16-conio_8h.html">cx16-conio.h</a>&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="printf_8h.html">printf.h</a>&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="stdio_8h.html">stdio.h</a>&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="division_8h.html">division.h</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="mos6522_8h.html">mos6522.h</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="multiply_8h.html">multiply.h</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="equinoxe_8h.html">equinoxe.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="equinoxe-floorengine_8h.html">equinoxe-floorengine.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#a33afcd9e1fcb2480d55499b2644d49af">   22</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#a33afcd9e1fcb2480d55499b2644d49af">vera_tile_clear</a>( <span class="keywordtype">byte</span> layer ) {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">byte</span> PaletteOffset = 1;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordtype">byte</span> Offset = 100;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    dword mapbase = <a class="code" href="cx16-veralib_8c.html#ab08f618f5894c8f7fb91b36db9a4287a">vera_mapbase_address</a>[layer];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="cx16-veralib_8h.html#a6ec456b8d85ef4a7107a70340ba2dc01">vera_vram_address0</a>(mapbase,<a class="code" href="cx16-vera_8h.html#aa31a7dd339f45a8c053380a8c383c109">VERA_INC_1</a>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">for</span>(word <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;64*20;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        *<a class="code" href="cx16-vera_8h.html#ad0200f6969acbb30de46038e81a25cb0">VERA_DATA0</a> = Offset;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        *<a class="code" href="cx16-vera_8h.html#ad0200f6969acbb30de46038e81a25cb0">VERA_DATA0</a> = PaletteOffset &lt;&lt; 4;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#a605fcf755b1f8a4c0eee110fc619cdd3">   38</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#a605fcf755b1f8a4c0eee110fc619cdd3">vera_tile_element</a>( <span class="keywordtype">byte</span> layer, <span class="keywordtype">byte</span> x, <span class="keywordtype">byte</span> y, word Segment ) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a>(4+x*4,y+12);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;%02u &quot;</span>,Segment);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">byte</span> resolution = 2;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_tile_segment.html">TileSegment</a> *<a class="code" href="struct_tile_segment.html">TileSegment</a> = &amp;(<a class="code" href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a>[Segment]);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    x = x &lt;&lt; resolution;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    y = y &lt;&lt; resolution;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    dword mapbase = <a class="code" href="cx16-veralib_8c.html#ab08f618f5894c8f7fb91b36db9a4287a">vera_mapbase_address</a>[layer];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">byte</span> shift = <a class="code" href="cx16-veralib_8c.html#a5d73e1c4467d8e7d521bc4d90754bc7e">vera_layer_rowshift</a>[layer];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    word rowskip = (word)1 &lt;&lt; shift;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    mapbase += ((word)y &lt;&lt; shift);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    mapbase += (x &lt;&lt; 1); <span class="comment">// 2 bytes per tile (one index + one palette)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> sr=0;sr&lt;4;sr+=2) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> r=0;r&lt;4;r+=2) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="cx16-veralib_8h.html#a6ec456b8d85ef4a7107a70340ba2dc01">vera_vram_address0</a>(mapbase,<a class="code" href="cx16-vera_8h.html#aa31a7dd339f45a8c053380a8c383c109">VERA_INC_1</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> sc=0;sc&lt;2;sc++) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> c=0;c&lt;2;c++) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                    <span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a> = sc + sr;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    <span class="keyword">struct </span><a class="code" href="struct_tile_part.html">TilePart</a> *<a class="code" href="struct_tile_part.html">TilePart</a> = &amp;<a class="code" href="equinoxe-floorengine_8h.html#a20d0e6871f42fb5673b4812b812ca1aa">TilePartDB</a>[(word)<a class="code" href="struct_tile_segment.html">TileSegment</a>-&gt;<a class="code" href="struct_tile_segment.html#a370f45ef2d9e85374fb152087e171d43">Composition</a>[<a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>]];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="struct_tile.html">Tile</a> *<a class="code" href="struct_tile.html">Tile</a> = <a class="code" href="struct_tile_part.html">TilePart</a>-&gt;<a class="code" href="struct_tile_part.html#abdcf78667571450be54abc47cdb70421">Tile</a>; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                    word <a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a> = <a class="code" href="struct_tile_part.html">TilePart</a>-&gt;<a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    word Offset = <a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a> + r + c;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    *<a class="code" href="cx16-vera_8h.html#ad0200f6969acbb30de46038e81a25cb0">VERA_DATA0</a> = &lt;Offset;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    *<a class="code" href="cx16-vera_8h.html#ad0200f6969acbb30de46038e81a25cb0">VERA_DATA0</a> = <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#a482a11a586796bef6b769f08b90fedef">PaletteOffset</a> &lt;&lt; 4 | &gt;Offset;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        mapbase += rowskip;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#ac68b936cddd3b74c607360145bbf4447">   77</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#ac68b936cddd3b74c607360145bbf4447">floor_init</a>(<span class="keywordtype">byte</span> y, <span class="keywordtype">byte</span> *<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>, <span class="keywordtype">byte</span> *<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;\no=%x, n=%x&quot;</span>, (word)<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>, (word)<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">byte</span> rnd = (byte)<a class="code" href="division_8h.html#a7493a230242c51c5435e701757d9abd6">modr16u</a>(<a class="code" href="stdlib_8h.html#a866c3f5e3e89035c3ba01b22d786d8bc">rand</a>(),36,0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_tile_segment.html">TileSegment</a> *<a class="code" href="struct_tile_segment.html">TileSegment</a> = &amp;(<a class="code" href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a>[(word)rnd]);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[0] = rnd;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> x=1;x&lt;10;x++) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a> *<a class="code" href="struct_tile_glue.html">TileGlue</a> = <a class="code" href="struct_tile_segment.html">TileSegment</a>-&gt;<a class="code" href="struct_tile_segment.html#a36fc07394826b7d1c6c9b9dd05084814">Glue</a>[1];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">byte</span> RndGlue = (byte)<a class="code" href="division_8h.html#a7493a230242c51c5435e701757d9abd6">modr16u</a>(<a class="code" href="stdlib_8h.html#a866c3f5e3e89035c3ba01b22d786d8bc">rand</a>(),<a class="code" href="struct_tile_glue.html">TileGlue</a>-&gt;<a class="code" href="struct_tile_glue.html#ac2285c2d4f1b2fa1cb590b6c014e5b87">CountGlue</a>,0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">byte</span> <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a> = <a class="code" href="struct_tile_glue.html">TileGlue</a>-&gt;<a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>[RndGlue];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="struct_tile_segment.html">TileSegment</a> = &amp;(<a class="code" href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a>[(word)<a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>]);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[x] = <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> x=0;x&lt;10;x++) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        word <a class="code" href="struct_tile.html">Tile</a> = (word)<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[x];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="equinoxe-floorengine_8c.html#a605fcf755b1f8a4c0eee110fc619cdd3">vera_tile_element</a>( 0, x, y, <a class="code" href="struct_tile.html">Tile</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">   97</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a>* <a class="code" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a>(<span class="keywordtype">byte</span> <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>, <span class="keywordtype">byte</span> GlueDirection ) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_tile_segment.html">TileSegment</a> *<a class="code" href="struct_tile_segment.html">TileSegment</a> = &amp;(<a class="code" href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a>[(word)GlueSegment]);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a> *<a class="code" href="struct_tile_glue.html">TileGlue</a> = <a class="code" href="struct_tile_segment.html">TileSegment</a>-&gt;<a class="code" href="struct_tile_segment.html#a36fc07394826b7d1c6c9b9dd05084814">Glue</a>[GlueDirection];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="struct_tile_glue.html">TileGlue</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// struct TileSegment* floor_get_random_gluesegment(struct TileGlue* TileGlue) {</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//     byte GlueSegment = TileGlue-&gt;GlueSegment[(byte)modr16u(rand(),TileGlue-&gt;CountGlue,0)];</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//     return GlueSegment;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#a5430f3c763780af7cb461438eecd8c8e">  108</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#a5430f3c763780af7cb461438eecd8c8e">floor_draw</a>(<span class="keywordtype">byte</span> y, <span class="keywordtype">byte</span> *<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>, <span class="keywordtype">byte</span> *<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">byte</span> TileResults[20];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">byte</span> TileResultsWeighted[20];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a>(40,y+12);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> x=0;x&lt;10;x++) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a> *TileGlueNew;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span>(x&gt;0) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">// Start from the west side ...</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            TileGlueNew = <a class="code" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a>(<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[x-1], 1);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="comment">// Start from the south side ...</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            TileGlueNew = <a class="code" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a>(<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>[0], 0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// Find the common tile segment(s) ...</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordtype">byte</span> TileResultCount = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0; <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;TileGlueNew-&gt;<a class="code" href="struct_tile_glue.html#ac2285c2d4f1b2fa1cb590b6c014e5b87">CountGlue</a>; <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordtype">byte</span> GlueSegmentNew = TileGlueNew-&gt;<a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>[<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordtype">byte</span> TileSouth = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordtype">byte</span> TileEast = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">if</span>(x&gt;0) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="comment">// Get the south side ...</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a> *TileGlueSouth = <a class="code" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a>(<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>[x], 0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>=0;<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>&lt;TileGlueSouth-&gt;<a class="code" href="struct_tile_glue.html#ac2285c2d4f1b2fa1cb590b6c014e5b87">CountGlue</a>;<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>++) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="keywordtype">byte</span> GlueSegmentSouth = TileGlueSouth-&gt;<a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>[<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    <span class="keywordflow">if</span>( GlueSegmentNew == GlueSegmentSouth ) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        TileSouth = 1;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                TileSouth = 1;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span>(x&lt;9) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="comment">// Get the southeast side ...</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a> *TileGlueSouthEast = <a class="code" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a>(<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>[x+1], 0);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>=0;<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>&lt;TileGlueSouthEast-&gt;<a class="code" href="struct_tile_glue.html#ac2285c2d4f1b2fa1cb590b6c014e5b87">CountGlue</a>;<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>++) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    <span class="keywordtype">byte</span> GlueSegmentSouthEast = TileGlueSouthEast-&gt;<a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>[<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    <span class="keyword">struct </span><a class="code" href="struct_tile_glue.html">TileGlue</a> *TileGlueEast = <a class="code" href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a>(GlueSegmentSouthEast,3);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> f=0;f&lt;TileGlueEast-&gt;<a class="code" href="struct_tile_glue.html#ac2285c2d4f1b2fa1cb590b6c014e5b87">CountGlue</a>;f++) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        <span class="keywordtype">byte</span> GlueSegmentEast = TileGlueEast-&gt;<a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>[f];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                        <span class="comment">// if(TileFloorOld[x+1]==9) {</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        <span class="comment">//     printf(&quot;g%02u/g%02u/g%02u &quot;, GlueSegmentNew, GlueSegmentEast, GlueSegmentSouthEast  );</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                        <span class="comment">// }</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        <span class="keywordflow">if</span>( GlueSegmentNew == GlueSegmentEast ) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                            TileEast = 1;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                TileEast = 1;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">if</span>(TileSouth == 1 &amp;&amp; TileEast == 1) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                TileResults[TileResultCount] = GlueSegmentNew;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                TileResultCount++;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span>( TileResultCount&gt;0) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="comment">// First we check the maximum weight for the weighted selection in the list.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordtype">byte</span> MaxWeight = 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordtype">byte</span> MinWeight = 255;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;TileResultCount;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keywordtype">byte</span> Segment = TileResults[<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keywordtype">byte</span> Weight = <a class="code" href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a>[(word)Segment].Weight; <span class="comment">// TODO: this mandatory case needs to be reported.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordflow">if</span>( Weight &gt; MaxWeight )</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    MaxWeight = Weight;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordtype">byte</span> Weight = (byte)<a class="code" href="division_8h.html#a7493a230242c51c5435e701757d9abd6">modr16u</a>(<a class="code" href="stdlib_8h.html#a866c3f5e3e89035c3ba01b22d786d8bc">rand</a>(),(word)(MaxWeight),0);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">// Now build list with weighted selection ...</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordtype">byte</span> TileResultsWeightedCount = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;TileResultCount;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordtype">byte</span> Segment = TileResults[<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordtype">byte</span> SegmentWeight = <a class="code" href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a>[(word)Segment].Weight;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">if</span>( SegmentWeight &gt;= Weight ) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    TileResultsWeighted[TileResultsWeightedCount] = Segment;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    TileResultsWeightedCount++;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span>(TileResultsWeightedCount==0) <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;error&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordtype">byte</span> <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a> = TileResultsWeighted[(byte)<a class="code" href="division_8h.html#a7493a230242c51c5435e701757d9abd6">modr16u</a>(<a class="code" href="stdlib_8h.html#a866c3f5e3e89035c3ba01b22d786d8bc">rand</a>(),(word)(TileResultsWeightedCount),0)];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[x] = <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordtype">byte</span> <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a> = 255;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[x] = <a class="code" href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">GlueSegment</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> x=0;x&lt;10;x++) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        word <a class="code" href="struct_tile.html">Tile</a> = (word)<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>[x];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a>(0,12+y); <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;y%02u&quot;</span>,y);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="equinoxe-floorengine_8c.html#a605fcf755b1f8a4c0eee110fc619cdd3">vera_tile_element</a>( 0, x, y, <a class="code" href="struct_tile.html">Tile</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#a70af4a3be3fd52bdd4da3e25b51ec9d4">  208</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#a70af4a3be3fd52bdd4da3e25b51ec9d4">tile_background</a>() {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">int</span> TileIndex = 0;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">int</span> TileIndexColumn = 0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">int</span> TileIndexRow = 0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    TileIndex = TileIndexRow &lt;&lt; 4 + TileIndexColumn;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="equinoxe-floorengine_8c.html#a33afcd9e1fcb2480d55499b2644d49af">vera_tile_clear</a>(0);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">byte</span> y=15;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="equinoxe-floorengine_8c.html#ac68b936cddd3b74c607360145bbf4447">floor_init</a>(y, <a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>, <a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;8;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        y--;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="equinoxe-floorengine_8c.html#a5430f3c763780af7cb461438eecd8c8e">floor_draw</a>(y, <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>?<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>:<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>, <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>?<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>:<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>++;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>&amp;=1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="cx16-veralib_8h.html#a754b449b4a4ae283976391b98e124331">vera_layer_set_vertical_scroll</a>(0,8*64);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#afe1012eddcef83feb065285ddbb11417">  228</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#afe1012eddcef83feb065285ddbb11417">show_memory_map</a>() {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;<a class="code" href="equinoxe-floorengine_8h.html#a112fd16fed921b24d56c1d51a4b13115">TILE_TYPES</a>;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_tile.html">Tile</a> *<a class="code" href="struct_tile.html">Tile</a> = <a class="code" href="equinoxe-floorengine_8h.html#a1bba396b3c60e42e1a8bf0c63725cc10">TileDB</a>[<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>];</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordtype">byte</span> <a class="code" href="struct_tile.html#aeb95ad7b79fb1204901a4b9f78f7d587">TileOffset</a> = <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aeb95ad7b79fb1204901a4b9f78f7d587">TileOffset</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a>(0, 30+<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;t:%u bram:%x:%p, vram:&quot;</span>, <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>, <a class="code" href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a>(<a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aaa4603c4efa12f735b2357f981580871">BRAM_Handle</a>), <a class="code" href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a>(<a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aaa4603c4efa12f735b2357f981580871">BRAM_Handle</a>));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> <a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>=0;<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>&lt;<a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#a2ca01a9c0594b163f81ead79b241c791">TileCount</a>;<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>++) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keyword">struct </span><a class="code" href="struct_tile_part.html">TilePart</a> *<a class="code" href="struct_tile_part.html">TilePart</a> = &amp;<a class="code" href="equinoxe-floorengine_8h.html#a20d0e6871f42fb5673b4812b812ca1aa">TilePartDB</a>[(word)(<a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a>+<a class="code" href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a>)];</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;%x:%p &quot;</span>, <a class="code" href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a>(<a class="code" href="struct_tile_part.html">TilePart</a>-&gt;<a class="code" href="struct_tile_part.html#ab458bd74036a8b7ef8d10ffa2ca1b0a5">VRAM_Handle</a>), <a class="code" href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a>(<a class="code" href="struct_tile_part.html">TilePart</a>-&gt;<a class="code" href="struct_tile_part.html#ab458bd74036a8b7ef8d10ffa2ca1b0a5">VRAM_Handle</a>));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#a933765ca5dcb84cf856a08743e4e15a6">  241</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#a933765ca5dcb84cf856a08743e4e15a6">tile_cpy_vram_from_bram</a>(<span class="keyword">struct</span> <a class="code" href="struct_tile.html">Tile</a> *<a class="code" href="struct_tile.html">Tile</a>) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="cx16-heap_8h.html#a1fb45efeb18336657f3c31fd4576dbaf">heap_ptr</a> ptr_bram_tile = <a class="code" href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a>(<a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aaa4603c4efa12f735b2357f981580871">BRAM_Handle</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="cx16-heap_8h.html#a79debd49c9dea1be52eb51c72344dacd">heap_bank</a> bank_bram_tile = <a class="code" href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a>(<a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aaa4603c4efa12f735b2357f981580871">BRAM_Handle</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">byte</span> TileCount = <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#a2ca01a9c0594b163f81ead79b241c791">TileCount</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    word TileSize = <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#afc1da51547d9f1bb7115d9983886714b">TileSize</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">byte</span> <a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a> = <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aeb95ad7b79fb1204901a4b9f78f7d587">TileOffset</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">byte</span> t=0;t&lt;TileCount;t++) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="cx16-heap_8h.html#a3c556a4011556bf68e2d3a37fe050e37">heap_handle</a> handle_vram_tile = <a class="code" href="cx16-heap_8h.html#a00b33488bca659988e30062e0264af7a">heap_alloc</a>(<a class="code" href="equinoxe_8h.html#a2f9cb4b633688c5cbde879fc1e73c41a">HEAP_SEGMENT_VRAM_FLOOR_TILE</a>, TileSize);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="cx16-heap_8h.html#a79debd49c9dea1be52eb51c72344dacd">heap_bank</a> bank_vram_tile = <a class="code" href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a>(handle_vram_tile);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="cx16-heap_8h.html#a1fb45efeb18336657f3c31fd4576dbaf">heap_ptr</a> ptr_vram_tile = <a class="code" href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a>(handle_vram_tile);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="equinoxe-palettes_8c.html#a4cd39404407d5a7b70c1e139e2c70b45">cx16_cpy_vram_from_bram</a>(bank_vram_tile, (word)ptr_vram_tile, bank_bram_tile, (<span class="keywordtype">byte</span>*)ptr_bram_tile, TileSize);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_tile_part.html">TilePart</a> *<a class="code" href="struct_tile_part.html">TilePart</a> = &amp;<a class="code" href="equinoxe-floorengine_8h.html#a20d0e6871f42fb5673b4812b812ca1aa">TilePartDB</a>[(word)(<a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a>+t)];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">// TODO: make shorter, missing fragments.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        word Offset = ((word)ptr_vram_tile - (word)0x2000);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        Offset = Offset &gt;&gt; 4;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        Offset = Offset &gt;&gt; 3;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="struct_tile_part.html">TilePart</a>-&gt;<a class="code" href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TileOffset</a> = Offset;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="struct_tile_part.html">TilePart</a>-&gt;<a class="code" href="struct_tile_part.html#ab458bd74036a8b7ef8d10ffa2ca1b0a5">VRAM_Handle</a> = handle_vram_tile;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        ptr_bram_tile = <a class="code" href="cx16_8h.html#a0138b3d8413f646f2f9b67252fa2fde5">cx16_bram_ptr_inc</a>(bank_bram_tile, ptr_bram_tile, TileSize);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        bank_bram_tile = <a class="code" href="cx16_8h.html#ade5bb38fc1c5896c6ef3e049fdcd305b">cx16_bram_bank_get</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">// Load the tile into bram using the new cx16 heap manager.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#ae8a811e90321394890dc2bf24fe4d339">  272</a></span>&#160;<a class="code" href="cx16-heap_8h.html#a3c556a4011556bf68e2d3a37fe050e37">heap_handle</a> <a class="code" href="equinoxe-floorengine_8c.html#ae8a811e90321394890dc2bf24fe4d339">tile_load</a>( <span class="keyword">struct</span> <a class="code" href="struct_tile.html">Tile</a> *<a class="code" href="struct_tile.html">Tile</a>) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="cx16-heap_8h.html#a3c556a4011556bf68e2d3a37fe050e37">heap_handle</a> handle_bram_tile = <a class="code" href="cx16-heap_8h.html#a00b33488bca659988e30062e0264af7a">heap_alloc</a>(<a class="code" href="equinoxe_8h.html#a9b0f82695ec8dcde292da74b492c664c">HEAP_SEGMENT_BRAM_TILES</a>, <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#a108e4a620ede8359ab73a50af5194b5b">TotalSize</a>);  <span class="comment">// Reserve enough memory on the heap for the tile loading.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="cx16-heap_8h.html#a1fb45efeb18336657f3c31fd4576dbaf">heap_ptr</a> ptr_bram_tile = <a class="code" href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a>(handle_bram_tile);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="cx16-heap_8h.html#a79debd49c9dea1be52eb51c72344dacd">heap_bank</a> bank_bram_tile = <a class="code" href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a>(handle_bram_tile);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="cx16-heap_8h.html#a3c556a4011556bf68e2d3a37fe050e37">heap_handle</a> data_handle_bram_tile = <a class="code" href="cx16-heap_8h.html#a616caae8492296d9cddcc82bfeb170b8">heap_data_handle</a>(handle_bram_tile);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;bram: %x:%p\n&quot;</span>, <a class="code" href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a>(handle_bram_tile), <a class="code" href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a>(handle_bram_tile));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="cx16_8h.html#a83f3359ac986d485598e0d970778ca57">cx16_ptr</a> ptr_bram_tile_end = <a class="code" href="cx16_8h.html#af1647e0038ba3f38426da1db251bdb9d">cx16_load_ram_banked</a>(1, 8, 0, <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#af4424f0d3af5275819bc38a858ffc972">File</a>, bank_bram_tile, ptr_bram_tile);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span>(!ptr_bram_tile_end) <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;error file %s\n&quot;</span>, <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#af4424f0d3af5275819bc38a858ffc972">File</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="struct_tile.html">Tile</a>-&gt;<a class="code" href="struct_tile.html#aaa4603c4efa12f735b2357f981580871">BRAM_Handle</a> = handle_bram_tile;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">while</span>(!<a class="code" href="cx16-kernal_8c.html#aa7ea54f8fce4a2dcb42d7b75af378a27">getin</a>());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span> handle_bram_tile;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="equinoxe-petscii-move_8c.html">equinoxe-petscii-move.c</a>&quot;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#acdef7a1fd863a6d3770c1268cb06add3">  291</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="equinoxe-floorengine_8c.html#acdef7a1fd863a6d3770c1268cb06add3">main</a>() {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// We are going to use only the kernal on the X16.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="cx16_8h.html#a9dd279e9c267836ab6ae9e6bb8837d3d">cx16_brom_bank_set</a>(<a class="code" href="cx16_8h.html#a9481f4c999b9dc907ea21f9de0a091a2">CX16_ROM_KERNAL</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// Memory is managed as follows:</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// HEAP SEGMENT                     VRAM                  BRAM</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// -------------------------        -----------------     -----------------</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// HEAP_SEGMENT_VRAM_PETSCII        01/B000 - 01/F800     01/A000 - 01/A400</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// HEAP_SEGMENT_VRAM_SPRITES        00/0000 - 01/B000     01/A400 - 01/C000</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// HEAP_SEGMENT_BRAM_SPRITES                              02/A000 - 20/C000</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// HEAP_SEGMENT_BRAM_PALETTE                              3F/A000 - 3F/C000</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="cx16-heap_8h.html#adf788b6b721333705c60aa63657c6bbe">heap_address</a> vram_petscii = <a class="code" href="equinoxe-petscii-move_8c.html#aadfbc8900059621e51d42a6c06c54938">petscii</a>();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Allocate the segment for the tiles in vram.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keyword">const</span> word VRAM_FLOOR_MAP_SIZE = 64*64*2;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keyword">const</span> word VRAM_FLOOR_TILE_SIZE = <a class="code" href="equinoxe-floorengine_8h.html#a45970eeedd6b0dd27027de0c643afe9d">TILE_FLOOR_COUNT</a>*32*32/2;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// Allocate the segment for the floor map in vram.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="cx16_8h.html#a69853b4f5d9d0876b7335f608b69cd54">cx16_vram_packed</a> vram_floor_map = <a class="code" href="cx16-heap_8h.html#a0171e26c4831250097086a0409a62af4">heap_segment_vram_floor</a>(</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="equinoxe_8h.html#a26e0dc70f8cb2caf0645fbff67ac8db6">HEAP_SEGMENT_VRAM_FLOOR_MAP</a>, </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="cx16_8h.html#ac902874d357e29150c04011f014f3192">cx16_vram_pack</a>(1, 0x0000), </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="cx16_8h.html#a40caf9ebbdacb8e8e9704d5ac98da6e2">cx16_size_pack</a>(0x2000), </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="cx16_8h.html#a6104d2987de49881a9f854a2ae476d42">cx16_bram_pack</a>(1, (<a class="code" href="cx16-heap_8h.html#a1fb45efeb18336657f3c31fd4576dbaf">heap_ptr</a>)0xA400), </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        0</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        );</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//heap_segment segment_vram_floor_map = heap_segment_vram(HEAP_SEGMENT_VRAM_FLOOR_MAP, 1, 0x2000, 1, 0x0000, 1, 0xA400, 0);</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="cx16_8h.html#a69853b4f5d9d0876b7335f608b69cd54">cx16_vram_packed</a> vram_floor_tile = <a class="code" href="cx16-heap_8h.html#a0171e26c4831250097086a0409a62af4">heap_segment_vram_floor</a>(</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="equinoxe_8h.html#a2f9cb4b633688c5cbde879fc1e73c41a">HEAP_SEGMENT_VRAM_FLOOR_TILE</a>, </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="cx16_8h.html#ac902874d357e29150c04011f014f3192">cx16_vram_pack</a>(1, (<a class="code" href="cx16_8h.html#a065d3fbe3bfd482312b89678371ac29f">cx16_offset</a>)0x2000), </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="cx16_8h.html#a40caf9ebbdacb8e8e9704d5ac98da6e2">cx16_size_pack</a>(0x8000), </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="cx16_8h.html#a6104d2987de49881a9f854a2ae476d42">cx16_bram_pack</a>(1, (<a class="code" href="cx16_8h.html#a83f3359ac986d485598e0d970778ca57">cx16_ptr</a>)0xA400), </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        0x100</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">//heap_segment segment_vram_floor_tile = heap_segment_vram(HEAP_SEGMENT_VRAM_FLOOR_TILE, 1, 0xA000, 1, 0x2000, 1, 0xA400, 0x100);</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="equinoxe-palettes_8c.html">equinoxe-palettes.c</a>&quot;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// Initialize the bram heap for tile loading.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="cx16-heap_8h.html#adf788b6b721333705c60aa63657c6bbe">heap_address</a> bram_floor_tile = <a class="code" href="cx16-heap_8h.html#ae980db9cce91543e60b9e07f8a95327a">heap_segment_bram</a>(</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="equinoxe_8h.html#a9b0f82695ec8dcde292da74b492c664c">HEAP_SEGMENT_BRAM_TILES</a>,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="cx16_8h.html#a6104d2987de49881a9f854a2ae476d42">cx16_bram_pack</a>(33,(<a class="code" href="cx16_8h.html#a83f3359ac986d485598e0d970778ca57">cx16_ptr</a>)0xA000),</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <a class="code" href="cx16_8h.html#a40caf9ebbdacb8e8e9704d5ac98da6e2">cx16_size_pack</a>(0x2000*8)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a>(0, 10);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Loading the graphics in main banked memory.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0; <a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;<a class="code" href="equinoxe-floorengine_8h.html#a112fd16fed921b24d56c1d51a4b13115">TILE_TYPES</a>;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="equinoxe-floorengine_8c.html#ae8a811e90321394890dc2bf24fe4d339">tile_load</a>(<a class="code" href="equinoxe-floorengine_8h.html#a1bba396b3c60e42e1a8bf0c63725cc10">TileDB</a>[<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>]);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// Now we activate the tile mode.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>=0;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>&lt;<a class="code" href="equinoxe-floorengine_8h.html#a112fd16fed921b24d56c1d51a4b13115">TILE_TYPES</a>;<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>++) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="equinoxe-floorengine_8c.html#a933765ca5dcb84cf856a08743e4e15a6">tile_cpy_vram_from_bram</a>(<a class="code" href="equinoxe-floorengine_8h.html#a1bba396b3c60e42e1a8bf0c63725cc10">TileDB</a>[<a class="code" href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a>]);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="equinoxe-floorengine_8h.html#ae98d42a2c0f8a71371f38c697a84260c">vram_floor_map_ulong</a> = 0x10000;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="cx16-veralib_8h.html#a42e3df54567861a6019d1fddfa7a6029">vera_layer_mode_tile</a>(0, <a class="code" href="equinoxe-floorengine_8h.html#ae98d42a2c0f8a71371f38c697a84260c">vram_floor_map_ulong</a>, 0x12000, 64, 64, 16, 16, 4);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="equinoxe-floorengine_8c.html#afe1012eddcef83feb065285ddbb11417">show_memory_map</a>();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="cx16-veralib_8h.html#aefd4fcb1300f9f4381937dd9299aabae">vera_layer_show</a>(0);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">//floor_init();</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="equinoxe-floorengine_8c.html#a70af4a3be3fd52bdd4da3e25b51ec9d4">tile_background</a>();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// Enable VSYNC IRQ (also set line bit 8 to 0)</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="6502_8h.html#af055224f182307b22de270908bdfda18">SEI</a>();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    *<a class="code" href="c64_8h.html#a91dac3f9333414b61fcae914519e7be7">KERNEL_IRQ</a> = &amp;irq_vsync;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    *<a class="code" href="cx16-vera_8h.html#aca6878acffb1fa0e96430964d4c530d6">VERA_IEN</a> = <a class="code" href="cx16-vera_8h.html#a350950073708f87c92d920d455da6a6c">VERA_VSYNC</a>; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="6502_8h.html#a44d1fb770b7cce1d861e1ebd52e7b752">CLI</a>();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">while</span>(!<a class="code" href="conio_8h.html#a355e3b9dd6d02551dc4528e228ce5a6f">kbhit</a>());</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Back to basic.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="cx16_8h.html#a9dd279e9c267836ab6ae9e6bb8837d3d">cx16_brom_bank_set</a>(<a class="code" href="cx16_8h.html#a01a5d8d930a1dd5615c29678b586474d">CX16_ROM_BASIC</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">//VSYNC Interrupt Routine</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="equinoxe-floorengine_8c.html#ac77ffc12980a521a6eb7371b65f1f707">  379</a></span>&#160;<a class="code" href="equinoxe-floorengine_8c.html#ac77ffc12980a521a6eb7371b65f1f707">__interrupt</a>(rom_sys_cx16) <span class="keywordtype">void</span> irq_vsync() {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// background scrolling</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="equinoxe_8h.html#a9cb376548970acd25cb78c900fd8c7e5">scroll_action</a>--) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="equinoxe_8h.html#a9cb376548970acd25cb78c900fd8c7e5">scroll_action</a> = 4;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a>(0, 10);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a>(<span class="stringliteral">&quot;vscroll:%u row:%u   &quot;</span>,<a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a>, <a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">if</span>((&lt;<a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a> &amp; 0xC0)==&lt;<a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a> ) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a>&lt;=7) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                dword dest_row = <a class="code" href="equinoxe-floorengine_8h.html#ae98d42a2c0f8a71371f38c697a84260c">vram_floor_map_ulong</a>+((<a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a>+8)*4*64*2);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                dword src_row = <a class="code" href="equinoxe-floorengine_8h.html#ae98d42a2c0f8a71371f38c697a84260c">vram_floor_map_ulong</a>+(<a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a>*4*64*2);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <a class="code" href="cx16-veralib_8h.html#ab9543a1bc2d3eb090e89f103b76d69e6">vera_cpy_vram_vram</a>(src_row, dest_row, (dword)64*4*2);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a>==0) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a>=8*64;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a> = 8;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <a class="code" href="equinoxe-floorengine_8c.html#a5430f3c763780af7cb461438eecd8c8e">floor_draw</a>((<span class="keywordtype">byte</span>)<a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a>-1, <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>?<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>:<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>, <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>?<a class="code" href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a>:<a class="code" href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>++;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <a class="code" href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a>&amp;=1;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a>--;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        } </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="cx16-veralib_8h.html#a754b449b4a4ae283976391b98e124331">vera_layer_set_vertical_scroll</a>(0,<a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a>--;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// Reset the VSYNC interrupt</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    *<a class="code" href="cx16-vera_8h.html#ab432c070ffa26780523f6627b4d33db7">VERA_ISR</a> = <a class="code" href="cx16-vera_8h.html#a350950073708f87c92d920d455da6a6c">VERA_VSYNC</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div>
<div class="ttc" id="a6502_8h_html"><div class="ttname"><a href="6502_8h.html">6502.h</a></div></div>
<div class="ttc" id="a6502_8h_html_a44d1fb770b7cce1d861e1ebd52e7b752"><div class="ttname"><a href="6502_8h.html#a44d1fb770b7cce1d861e1ebd52e7b752">CLI</a></div><div class="ttdeci">void CLI()</div><div class="ttdef"><b>Definition:</b> <a href="6502_8c_source.html#l00012">6502.c:12</a></div></div>
<div class="ttc" id="a6502_8h_html_af055224f182307b22de270908bdfda18"><div class="ttname"><a href="6502_8h.html#af055224f182307b22de270908bdfda18">SEI</a></div><div class="ttdeci">void SEI()</div><div class="ttdef"><b>Definition:</b> <a href="6502_8c_source.html#l00006">6502.c:6</a></div></div>
<div class="ttc" id="ac64_8h_html_a91dac3f9333414b61fcae914519e7be7"><div class="ttname"><a href="c64_8h.html#a91dac3f9333414b61fcae914519e7be7">KERNEL_IRQ</a></div><div class="ttdeci">IRQ_TYPE *const KERNEL_IRQ</div><div class="ttdef"><b>Definition:</b> <a href="c64_8h_source.html#l00060">c64.h:60</a></div></div>
<div class="ttc" id="aconio_8h_html"><div class="ttname"><a href="conio_8h.html">conio.h</a></div></div>
<div class="ttc" id="aconio_8h_html_a355e3b9dd6d02551dc4528e228ce5a6f"><div class="ttname"><a href="conio_8h.html#a355e3b9dd6d02551dc4528e228ce5a6f">kbhit</a></div><div class="ttdeci">unsigned char kbhit(void)</div><div class="ttdef"><b>Definition:</b> <a href="conio-atarixl_8c_source.html#l00196">conio-atarixl.c:196</a></div></div>
<div class="ttc" id="aconio_8h_html_a9ef2e230b1a50277b0ba7fc9eeaec789"><div class="ttname"><a href="conio_8h.html#a9ef2e230b1a50277b0ba7fc9eeaec789">gotoxy</a></div><div class="ttdeci">void gotoxy(unsigned char x, unsigned char y)</div><div class="ttdef"><b>Definition:</b> <a href="conio-atarixl_8c_source.html#l00127">conio-atarixl.c:127</a></div></div>
<div class="ttc" id="acx16-conio_8h_html"><div class="ttname"><a href="cx16-conio_8h.html">cx16-conio.h</a></div></div>
<div class="ttc" id="acx16-heap_8h_html"><div class="ttname"><a href="cx16-heap_8h.html">cx16-heap.h</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a00b33488bca659988e30062e0264af7a"><div class="ttname"><a href="cx16-heap_8h.html#a00b33488bca659988e30062e0264af7a">heap_alloc</a></div><div class="ttdeci">heap_handle heap_alloc(heap_segment Segment, heap_size Size)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8c_source.html#l00531">cx16-heap.c:531</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a0171e26c4831250097086a0409a62af4"><div class="ttname"><a href="cx16-heap_8h.html#a0171e26c4831250097086a0409a62af4">heap_segment_vram_floor</a></div><div class="ttdeci">heap_address heap_segment_vram_floor(heap_segment Segment, cx16_vram_packed HeapFloorVram, cx16_size_packed HeapSizeVram, cx16_bram_packed HeaderFloorBram, cx16_size_packed HeaderSizeBram)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8c_source.html#l00501">cx16-heap.c:501</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a0a48f10030633b8fe84b4692d145f9c0"><div class="ttname"><a href="cx16-heap_8h.html#a0a48f10030633b8fe84b4692d145f9c0">heap_data_bank</a></div><div class="ttdeci">heap_bank heap_data_bank(heap_handle handle)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8c_source.html#l00049">cx16-heap.c:49</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a1fb45efeb18336657f3c31fd4576dbaf"><div class="ttname"><a href="cx16-heap_8h.html#a1fb45efeb18336657f3c31fd4576dbaf">heap_ptr</a></div><div class="ttdeci">unsigned char * heap_ptr</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8h_source.html#l00008">cx16-heap.h:8</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a3c556a4011556bf68e2d3a37fe050e37"><div class="ttname"><a href="cx16-heap_8h.html#a3c556a4011556bf68e2d3a37fe050e37">heap_handle</a></div><div class="ttdeci">unsigned int heap_handle</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8h_source.html#l00003">cx16-heap.h:3</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a616caae8492296d9cddcc82bfeb170b8"><div class="ttname"><a href="cx16-heap_8h.html#a616caae8492296d9cddcc82bfeb170b8">heap_data_handle</a></div><div class="ttdeci">heap_handle heap_data_handle(heap_handle handle)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8c_source.html#l00038">cx16-heap.c:38</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a79debd49c9dea1be52eb51c72344dacd"><div class="ttname"><a href="cx16-heap_8h.html#a79debd49c9dea1be52eb51c72344dacd">heap_bank</a></div><div class="ttdeci">byte heap_bank</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8h_source.html#l00007">cx16-heap.h:7</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_a90b8f590de0a80cc643fad5f17e6a719"><div class="ttname"><a href="cx16-heap_8h.html#a90b8f590de0a80cc643fad5f17e6a719">heap_data_ptr</a></div><div class="ttdeci">heap_ptr heap_data_ptr(heap_handle handle)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8c_source.html#l00070">cx16-heap.c:70</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_adf788b6b721333705c60aa63657c6bbe"><div class="ttname"><a href="cx16-heap_8h.html#adf788b6b721333705c60aa63657c6bbe">heap_address</a></div><div class="ttdeci">unsigned int heap_address</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8h_source.html#l00002">cx16-heap.h:2</a></div></div>
<div class="ttc" id="acx16-heap_8h_html_ae980db9cce91543e60b9e07f8a95327a"><div class="ttname"><a href="cx16-heap_8h.html#ae980db9cce91543e60b9e07f8a95327a">heap_segment_bram</a></div><div class="ttdeci">heap_address heap_segment_bram(heap_segment Segment, cx16_vram_packed HeapFloorBram, cx16_size_packed HeapSizeBram)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-heap_8c_source.html#l00439">cx16-heap.c:439</a></div></div>
<div class="ttc" id="acx16-kernal_8c_html_aa7ea54f8fce4a2dcb42d7b75af378a27"><div class="ttname"><a href="cx16-kernal_8c.html#aa7ea54f8fce4a2dcb42d7b75af378a27">getin</a></div><div class="ttdeci">char getin()</div><div class="ttdef"><b>Definition:</b> <a href="cx16-kernal_8c_source.html#l00463">cx16-kernal.c:463</a></div></div>
<div class="ttc" id="acx16-vera_8h_html_a350950073708f87c92d920d455da6a6c"><div class="ttname"><a href="cx16-vera_8h.html#a350950073708f87c92d920d455da6a6c">VERA_VSYNC</a></div><div class="ttdeci">byte const VERA_VSYNC</div><div class="ttdef"><b>Definition:</b> <a href="cx16-vera_8h_source.html#l00098">cx16-vera.h:98</a></div></div>
<div class="ttc" id="acx16-vera_8h_html_aa31a7dd339f45a8c053380a8c383c109"><div class="ttname"><a href="cx16-vera_8h.html#aa31a7dd339f45a8c053380a8c383c109">VERA_INC_1</a></div><div class="ttdeci">byte const VERA_INC_1</div><div class="ttdef"><b>Definition:</b> <a href="cx16-vera_8h_source.html#l00046">cx16-vera.h:46</a></div></div>
<div class="ttc" id="acx16-vera_8h_html_ab432c070ffa26780523f6627b4d33db7"><div class="ttname"><a href="cx16-vera_8h.html#ab432c070ffa26780523f6627b4d33db7">VERA_ISR</a></div><div class="ttdeci">byte *const VERA_ISR</div><div class="ttdef"><b>Definition:</b> <a href="cx16-vera_8h_source.html#l00107">cx16-vera.h:107</a></div></div>
<div class="ttc" id="acx16-vera_8h_html_aca6878acffb1fa0e96430964d4c530d6"><div class="ttname"><a href="cx16-vera_8h.html#aca6878acffb1fa0e96430964d4c530d6">VERA_IEN</a></div><div class="ttdeci">byte *const VERA_IEN</div><div class="ttdef"><b>Definition:</b> <a href="cx16-vera_8h_source.html#l00094">cx16-vera.h:94</a></div></div>
<div class="ttc" id="acx16-vera_8h_html_ad0200f6969acbb30de46038e81a25cb0"><div class="ttname"><a href="cx16-vera_8h.html#ad0200f6969acbb30de46038e81a25cb0">VERA_DATA0</a></div><div class="ttdeci">const byte * VERA_DATA0</div><div class="ttdef"><b>Definition:</b> <a href="cx16-vera_8h_source.html#l00078">cx16-vera.h:78</a></div></div>
<div class="ttc" id="acx16-veralib_8c_html_a5d73e1c4467d8e7d521bc4d90754bc7e"><div class="ttname"><a href="cx16-veralib_8c.html#a5d73e1c4467d8e7d521bc4d90754bc7e">vera_layer_rowshift</a></div><div class="ttdeci">__mem volatile byte vera_layer_rowshift[2]</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l00017">cx16-veralib.c:17</a></div></div>
<div class="ttc" id="acx16-veralib_8c_html_ab08f618f5894c8f7fb91b36db9a4287a"><div class="ttname"><a href="cx16-veralib_8c.html#ab08f618f5894c8f7fb91b36db9a4287a">vera_mapbase_address</a></div><div class="ttdeci">__mem volatile dword vera_mapbase_address[2]</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l00011">cx16-veralib.c:11</a></div></div>
<div class="ttc" id="acx16-veralib_8h_html"><div class="ttname"><a href="cx16-veralib_8h.html">cx16-veralib.h</a></div></div>
<div class="ttc" id="acx16-veralib_8h_html_a42e3df54567861a6019d1fddfa7a6029"><div class="ttname"><a href="cx16-veralib_8h.html#a42e3df54567861a6019d1fddfa7a6029">vera_layer_mode_tile</a></div><div class="ttdeci">void vera_layer_mode_tile(byte layer, dword mapbase_address, dword tilebase_address, word mapwidth, word mapheight, byte tilewidth, byte tileheight, byte color_depth)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l00553">cx16-veralib.c:553</a></div></div>
<div class="ttc" id="acx16-veralib_8h_html_a6ec456b8d85ef4a7107a70340ba2dc01"><div class="ttname"><a href="cx16-veralib_8h.html#a6ec456b8d85ef4a7107a70340ba2dc01">vera_vram_address0</a></div><div class="ttdeci">void vera_vram_address0(dword bankaddr, byte incr)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l00070">cx16-veralib.c:70</a></div></div>
<div class="ttc" id="acx16-veralib_8h_html_a754b449b4a4ae283976391b98e124331"><div class="ttname"><a href="cx16-veralib_8h.html#a754b449b4a4ae283976391b98e124331">vera_layer_set_vertical_scroll</a></div><div class="ttdeci">void vera_layer_set_vertical_scroll(byte layer, word scroll)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l00515">cx16-veralib.c:515</a></div></div>
<div class="ttc" id="acx16-veralib_8h_html_ab9543a1bc2d3eb090e89f103b76d69e6"><div class="ttname"><a href="cx16-veralib_8h.html#ab9543a1bc2d3eb090e89f103b76d69e6">vera_cpy_vram_vram</a></div><div class="ttdeci">void vera_cpy_vram_vram(dword vsrc, dword vdest, dword num)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l01103">cx16-veralib.c:1103</a></div></div>
<div class="ttc" id="acx16-veralib_8h_html_aefd4fcb1300f9f4381937dd9299aabae"><div class="ttname"><a href="cx16-veralib_8h.html#aefd4fcb1300f9f4381937dd9299aabae">vera_layer_show</a></div><div class="ttdeci">void vera_layer_show(byte layer)</div><div class="ttdef"><b>Definition:</b> <a href="cx16-veralib_8c_source.html#l00303">cx16-veralib.c:303</a></div></div>
<div class="ttc" id="acx16_8h_html"><div class="ttname"><a href="cx16_8h.html">cx16.h</a></div><div class="ttdoc">Contains functions to control the features of the Commander X16. Commander X16 Functions....</div></div>
<div class="ttc" id="acx16_8h_html_a0138b3d8413f646f2f9b67252fa2fde5"><div class="ttname"><a href="cx16_8h.html#a0138b3d8413f646f2f9b67252fa2fde5">cx16_bram_ptr_inc</a></div><div class="ttdeci">unsigned char * cx16_bram_ptr_inc(char bank, char *sptr, unsigned int inc)</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8c_source.html#l00032">cx16.c:32</a></div></div>
<div class="ttc" id="acx16_8h_html_a01a5d8d930a1dd5615c29678b586474d"><div class="ttname"><a href="cx16_8h.html#a01a5d8d930a1dd5615c29678b586474d">CX16_ROM_BASIC</a></div><div class="ttdeci">byte const CX16_ROM_BASIC</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8h_source.html#l00069">cx16.h:69</a></div></div>
<div class="ttc" id="acx16_8h_html_a065d3fbe3bfd482312b89678371ac29f"><div class="ttname"><a href="cx16_8h.html#a065d3fbe3bfd482312b89678371ac29f">cx16_offset</a></div><div class="ttdeci">unsigned int cx16_offset</div><div class="ttdoc">A pointer location in vera ram, excluding any bank information!</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8h_source.html#l00081">cx16.h:81</a></div></div>
<div class="ttc" id="acx16_8h_html_a40caf9ebbdacb8e8e9704d5ac98da6e2"><div class="ttname"><a href="cx16_8h.html#a40caf9ebbdacb8e8e9704d5ac98da6e2">cx16_size_pack</a></div><div class="ttdeci">cx16_size_packed cx16_size_pack(cx16_size size)</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8c_source.html#l00138">cx16.c:138</a></div></div>
<div class="ttc" id="acx16_8h_html_a6104d2987de49881a9f854a2ae476d42"><div class="ttname"><a href="cx16_8h.html#a6104d2987de49881a9f854a2ae476d42">cx16_bram_pack</a></div><div class="ttdeci">cx16_bram_packed cx16_bram_pack(cx16_bank bank, cx16_ptr ptr)</div><div class="ttdoc">Create a packed banked ram pointer from an 8 bit bank and 16 bit pointer, which is compressed in a 2 ...</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8c_source.html#l00078">cx16.c:78</a></div></div>
<div class="ttc" id="acx16_8h_html_a69853b4f5d9d0876b7335f608b69cd54"><div class="ttname"><a href="cx16_8h.html#a69853b4f5d9d0876b7335f608b69cd54">cx16_vram_packed</a></div><div class="ttdeci">unsigned int cx16_vram_packed</div><div class="ttdoc">Packed pointer to a location in banked vera ram.</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8h_source.html#l00077">cx16.h:77</a></div></div>
<div class="ttc" id="acx16_8h_html_a83f3359ac986d485598e0d970778ca57"><div class="ttname"><a href="cx16_8h.html#a83f3359ac986d485598e0d970778ca57">cx16_ptr</a></div><div class="ttdeci">unsigned char * cx16_ptr</div><div class="ttdoc">A pointer location in ram or banked ram, excluding any bank information!</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8h_source.html#l00079">cx16.h:79</a></div></div>
<div class="ttc" id="acx16_8h_html_a9481f4c999b9dc907ea21f9de0a091a2"><div class="ttname"><a href="cx16_8h.html#a9481f4c999b9dc907ea21f9de0a091a2">CX16_ROM_KERNAL</a></div><div class="ttdeci">byte const CX16_ROM_KERNAL</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8h_source.html#l00068">cx16.h:68</a></div></div>
<div class="ttc" id="acx16_8h_html_a9dd279e9c267836ab6ae9e6bb8837d3d"><div class="ttname"><a href="cx16_8h.html#a9dd279e9c267836ab6ae9e6bb8837d3d">cx16_brom_bank_set</a></div><div class="ttdeci">unsigned char cx16_brom_bank_set(unsigned char bank)</div></div>
<div class="ttc" id="acx16_8h_html_ac902874d357e29150c04011f014f3192"><div class="ttname"><a href="cx16_8h.html#ac902874d357e29150c04011f014f3192">cx16_vram_pack</a></div><div class="ttdeci">cx16_vram_packed cx16_vram_pack(cx16_bank bank, cx16_offset offset)</div><div class="ttdoc">Create a packed vera ram pointer from an 8 bit bank and 16 bit offset, which is compressed in a 2 byt...</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8c_source.html#l00113">cx16.c:113</a></div></div>
<div class="ttc" id="acx16_8h_html_ade5bb38fc1c5896c6ef3e049fdcd305b"><div class="ttname"><a href="cx16_8h.html#ade5bb38fc1c5896c6ef3e049fdcd305b">cx16_bram_bank_get</a></div><div class="ttdeci">unsigned char cx16_bram_bank_get()</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8c_source.html#l00027">cx16.c:27</a></div></div>
<div class="ttc" id="acx16_8h_html_af1647e0038ba3f38426da1db251bdb9d"><div class="ttname"><a href="cx16_8h.html#af1647e0038ba3f38426da1db251bdb9d">cx16_load_ram_banked</a></div><div class="ttdeci">cx16_ptr cx16_load_ram_banked(char channel, char device, char secondary, char *filename, cx16_bank bank, cx16_ptr sptr)</div><div class="ttdoc">Load a file to banked ram located between address 0xA000-0xC000 incrementing the banks.</div><div class="ttdef"><b>Definition:</b> <a href="cx16_8c_source.html#l00164">cx16.c:164</a></div></div>
<div class="ttc" id="adivision_8h_html"><div class="ttname"><a href="division_8h.html">division.h</a></div></div>
<div class="ttc" id="adivision_8h_html_a7493a230242c51c5435e701757d9abd6"><div class="ttname"><a href="division_8h.html#a7493a230242c51c5435e701757d9abd6">modr16u</a></div><div class="ttdeci">unsigned int modr16u(unsigned int dividend, unsigned int divisor, unsigned int rem)</div><div class="ttdef"><b>Definition:</b> <a href="division_8c_source.html#l00077">division.c:77</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_a0eacdbcc334468aafcc949c545a81bfe"><div class="ttname"><a href="equinoxe-floorengine_8c.html#a0eacdbcc334468aafcc949c545a81bfe">floor_get_glue</a></div><div class="ttdeci">struct TileGlue * floor_get_glue(byte GlueSegment, byte GlueDirection)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00097">equinoxe-floorengine.c:97</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_a33afcd9e1fcb2480d55499b2644d49af"><div class="ttname"><a href="equinoxe-floorengine_8c.html#a33afcd9e1fcb2480d55499b2644d49af">vera_tile_clear</a></div><div class="ttdeci">void vera_tile_clear(byte layer)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00022">equinoxe-floorengine.c:22</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_a5430f3c763780af7cb461438eecd8c8e"><div class="ttname"><a href="equinoxe-floorengine_8c.html#a5430f3c763780af7cb461438eecd8c8e">floor_draw</a></div><div class="ttdeci">void floor_draw(byte y, byte *TileFloorNew, byte *TileFloorOld)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00108">equinoxe-floorengine.c:108</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_a605fcf755b1f8a4c0eee110fc619cdd3"><div class="ttname"><a href="equinoxe-floorengine_8c.html#a605fcf755b1f8a4c0eee110fc619cdd3">vera_tile_element</a></div><div class="ttdeci">void vera_tile_element(byte layer, byte x, byte y, word Segment)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00038">equinoxe-floorengine.c:38</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_a70af4a3be3fd52bdd4da3e25b51ec9d4"><div class="ttname"><a href="equinoxe-floorengine_8c.html#a70af4a3be3fd52bdd4da3e25b51ec9d4">tile_background</a></div><div class="ttdeci">void tile_background()</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00208">equinoxe-floorengine.c:208</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_a933765ca5dcb84cf856a08743e4e15a6"><div class="ttname"><a href="equinoxe-floorengine_8c.html#a933765ca5dcb84cf856a08743e4e15a6">tile_cpy_vram_from_bram</a></div><div class="ttdeci">void tile_cpy_vram_from_bram(struct Tile *Tile)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00241">equinoxe-floorengine.c:241</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_ac68b936cddd3b74c607360145bbf4447"><div class="ttname"><a href="equinoxe-floorengine_8c.html#ac68b936cddd3b74c607360145bbf4447">floor_init</a></div><div class="ttdeci">void floor_init(byte y, byte *TileFloorNew, byte *TileFloorOld)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00077">equinoxe-floorengine.c:77</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_ac77ffc12980a521a6eb7371b65f1f707"><div class="ttname"><a href="equinoxe-floorengine_8c.html#ac77ffc12980a521a6eb7371b65f1f707">__interrupt</a></div><div class="ttdeci">__interrupt(rom_sys_cx16)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00379">equinoxe-floorengine.c:379</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_acdef7a1fd863a6d3770c1268cb06add3"><div class="ttname"><a href="equinoxe-floorengine_8c.html#acdef7a1fd863a6d3770c1268cb06add3">main</a></div><div class="ttdeci">void main()</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00291">equinoxe-floorengine.c:291</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_ae8a811e90321394890dc2bf24fe4d339"><div class="ttname"><a href="equinoxe-floorengine_8c.html#ae8a811e90321394890dc2bf24fe4d339">tile_load</a></div><div class="ttdeci">heap_handle tile_load(struct Tile *Tile)</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00272">equinoxe-floorengine.c:272</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8c_html_afe1012eddcef83feb065285ddbb11417"><div class="ttname"><a href="equinoxe-floorengine_8c.html#afe1012eddcef83feb065285ddbb11417">show_memory_map</a></div><div class="ttdeci">void show_memory_map()</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8c_source.html#l00228">equinoxe-floorengine.c:228</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html"><div class="ttname"><a href="equinoxe-floorengine_8h.html">equinoxe-floorengine.h</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_a112fd16fed921b24d56c1d51a4b13115"><div class="ttname"><a href="equinoxe-floorengine_8h.html#a112fd16fed921b24d56c1d51a4b13115">TILE_TYPES</a></div><div class="ttdeci">byte const TILE_TYPES</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00026">equinoxe-floorengine.h:26</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_a1bba396b3c60e42e1a8bf0c63725cc10"><div class="ttname"><a href="equinoxe-floorengine_8h.html#a1bba396b3c60e42e1a8bf0c63725cc10">TileDB</a></div><div class="ttdeci">__mem struct Tile * TileDB[4]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00027">equinoxe-floorengine.h:27</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_a20d0e6871f42fb5673b4812b812ca1aa"><div class="ttname"><a href="equinoxe-floorengine_8h.html#a20d0e6871f42fb5673b4812b812ca1aa">TilePartDB</a></div><div class="ttdeci">struct TilePart TilePartDB[56]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00027">equinoxe-floorengine.h:35</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_a45970eeedd6b0dd27027de0c643afe9d"><div class="ttname"><a href="equinoxe-floorengine_8h.html#a45970eeedd6b0dd27027de0c643afe9d">TILE_FLOOR_COUNT</a></div><div class="ttdeci">byte const TILE_FLOOR_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00230">equinoxe-floorengine.h:230</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_a51be4ec51100ab6f22ea9690739a2aa0"><div class="ttname"><a href="equinoxe-floorengine_8h.html#a51be4ec51100ab6f22ea9690739a2aa0">TileSegmentDB</a></div><div class="ttdeci">struct TileSegment TileSegmentDB[36]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00180">equinoxe-floorengine.h:188</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_abaaa3f57c9f6528cc1fd9decfcf701cc"><div class="ttname"><a href="equinoxe-floorengine_8h.html#abaaa3f57c9f6528cc1fd9decfcf701cc">TileFloorOld</a></div><div class="ttdeci">byte TileFloorOld[TILES]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00234">equinoxe-floorengine.h:234</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_ae09ac0b43955cbf96492e2a0e737c1c1"><div class="ttname"><a href="equinoxe-floorengine_8h.html#ae09ac0b43955cbf96492e2a0e737c1c1">TileFloorNew</a></div><div class="ttdeci">byte TileFloorNew[TILES]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00233">equinoxe-floorengine.h:233</a></div></div>
<div class="ttc" id="aequinoxe-floorengine_8h_html_ae98d42a2c0f8a71371f38c697a84260c"><div class="ttname"><a href="equinoxe-floorengine_8h.html#ae98d42a2c0f8a71371f38c697a84260c">vram_floor_map_ulong</a></div><div class="ttdeci">volatile unsigned long vram_floor_map_ulong</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00236">equinoxe-floorengine.h:236</a></div></div>
<div class="ttc" id="aequinoxe-palettes_8c_html"><div class="ttname"><a href="equinoxe-palettes_8c.html">equinoxe-palettes.c</a></div></div>
<div class="ttc" id="aequinoxe-palettes_8c_html_a4cd39404407d5a7b70c1e139e2c70b45"><div class="ttname"><a href="equinoxe-palettes_8c.html#a4cd39404407d5a7b70c1e139e2c70b45">cx16_cpy_vram_from_bram</a></div><div class="ttdeci">cx16_cpy_vram_from_bram(VERA_PALETTE_BANK,(word) VERA_PALETTE_PTR+32, bank_bram_palettes, ptr_bram_palettes,(ptr_bram_end-ptr_bram_palettes))</div></div>
<div class="ttc" id="aequinoxe-petscii-move_8c_html"><div class="ttname"><a href="equinoxe-petscii-move_8c.html">equinoxe-petscii-move.c</a></div></div>
<div class="ttc" id="aequinoxe-petscii-move_8c_html_aadfbc8900059621e51d42a6c06c54938"><div class="ttname"><a href="equinoxe-petscii-move_8c.html#aadfbc8900059621e51d42a6c06c54938">petscii</a></div><div class="ttdeci">heap_address petscii()</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-petscii-move_8c_source.html#l00001">equinoxe-petscii-move.c:1</a></div></div>
<div class="ttc" id="aequinoxe_8h_html"><div class="ttname"><a href="equinoxe_8h.html">equinoxe.h</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a26e0dc70f8cb2caf0645fbff67ac8db6"><div class="ttname"><a href="equinoxe_8h.html#a26e0dc70f8cb2caf0645fbff67ac8db6">HEAP_SEGMENT_VRAM_FLOOR_MAP</a></div><div class="ttdeci">const byte HEAP_SEGMENT_VRAM_FLOOR_MAP</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00011">equinoxe.h:11</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a2af223396c6b56d44d8c96fed09f0d22"><div class="ttname"><a href="equinoxe_8h.html#a2af223396c6b56d44d8c96fed09f0d22">row</a></div><div class="ttdeci">volatile word row</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00030">equinoxe.h:30</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a2f9cb4b633688c5cbde879fc1e73c41a"><div class="ttname"><a href="equinoxe_8h.html#a2f9cb4b633688c5cbde879fc1e73c41a">HEAP_SEGMENT_VRAM_FLOOR_TILE</a></div><div class="ttdeci">const byte HEAP_SEGMENT_VRAM_FLOOR_TILE</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00012">equinoxe.h:12</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a3e9a413b5d5a03ca5d5ea934338a0dff"><div class="ttname"><a href="equinoxe_8h.html#a3e9a413b5d5a03ca5d5ea934338a0dff">s</a></div><div class="ttdeci">volatile byte s</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00031">equinoxe.h:31</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a72750bb1fadc00717641830855c9860b"><div class="ttname"><a href="equinoxe_8h.html#a72750bb1fadc00717641830855c9860b">i</a></div><div class="ttdeci">volatile byte i</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00027">equinoxe.h:27</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a9606f4b7e7bae57475a3bfd4fc04d46a"><div class="ttname"><a href="equinoxe_8h.html#a9606f4b7e7bae57475a3bfd4fc04d46a">j</a></div><div class="ttdeci">volatile byte j</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00028">equinoxe.h:28</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a9b0f82695ec8dcde292da74b492c664c"><div class="ttname"><a href="equinoxe_8h.html#a9b0f82695ec8dcde292da74b492c664c">HEAP_SEGMENT_BRAM_TILES</a></div><div class="ttdeci">const byte HEAP_SEGMENT_BRAM_TILES</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00007">equinoxe.h:7</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_a9cb376548970acd25cb78c900fd8c7e5"><div class="ttname"><a href="equinoxe_8h.html#a9cb376548970acd25cb78c900fd8c7e5">scroll_action</a></div><div class="ttdeci">volatile byte scroll_action</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00038">equinoxe.h:38</a></div></div>
<div class="ttc" id="aequinoxe_8h_html_af90b8eb8b013b1e3be43743a8af29b20"><div class="ttname"><a href="equinoxe_8h.html#af90b8eb8b013b1e3be43743a8af29b20">vscroll</a></div><div class="ttdeci">volatile word vscroll</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe_8h_source.html#l00032">equinoxe.h:32</a></div></div>
<div class="ttc" id="akernal_8h_html"><div class="ttname"><a href="kernal_8h.html">kernal.h</a></div></div>
<div class="ttc" id="amos6522_8h_html"><div class="ttname"><a href="mos6522_8h.html">mos6522.h</a></div></div>
<div class="ttc" id="amultiply_8h_html"><div class="ttname"><a href="multiply_8h.html">multiply.h</a></div></div>
<div class="ttc" id="aprintf_8h_html"><div class="ttname"><a href="printf_8h.html">printf.h</a></div></div>
<div class="ttc" id="aprintf_8h_html_a63c54f1d737929378b379911b1ca4a45"><div class="ttname"><a href="printf_8h.html#a63c54f1d737929378b379911b1ca4a45">printf</a></div><div class="ttdeci">void printf(char *format,...)</div></div>
<div class="ttc" id="astdio_8h_html"><div class="ttname"><a href="stdio_8h.html">stdio.h</a></div></div>
<div class="ttc" id="astdlib_8h_html_a866c3f5e3e89035c3ba01b22d786d8bc"><div class="ttname"><a href="stdlib_8h.html#a866c3f5e3e89035c3ba01b22d786d8bc">rand</a></div><div class="ttdeci">unsigned int rand()</div><div class="ttdef"><b>Definition:</b> <a href="stdlib_8c_source.html#l00295">stdlib.c:295</a></div></div>
<div class="ttc" id="astruct_tile_glue_html"><div class="ttname"><a href="struct_tile_glue.html">TileGlue</a></div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00096">equinoxe-floorengine.h:96</a></div></div>
<div class="ttc" id="astruct_tile_glue_html_ac2285c2d4f1b2fa1cb590b6c014e5b87"><div class="ttname"><a href="struct_tile_glue.html#ac2285c2d4f1b2fa1cb590b6c014e5b87">TileGlue::CountGlue</a></div><div class="ttdeci">byte CountGlue</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00097">equinoxe-floorengine.h:97</a></div></div>
<div class="ttc" id="astruct_tile_glue_html_af262c1332f2e3ef8326361fb7c3ece5d"><div class="ttname"><a href="struct_tile_glue.html#af262c1332f2e3ef8326361fb7c3ece5d">TileGlue::GlueSegment</a></div><div class="ttdeci">byte * GlueSegment</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00098">equinoxe-floorengine.h:98</a></div></div>
<div class="ttc" id="astruct_tile_html"><div class="ttname"><a href="struct_tile.html">Tile</a></div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00001">equinoxe-flightengine.h:1</a></div></div>
<div class="ttc" id="astruct_tile_html_a108e4a620ede8359ab73a50af5194b5b"><div class="ttname"><a href="struct_tile.html#a108e4a620ede8359ab73a50af5194b5b">Tile::TotalSize</a></div><div class="ttdeci">word TotalSize</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00005">equinoxe-flightengine.h:5</a></div></div>
<div class="ttc" id="astruct_tile_html_a2ca01a9c0594b163f81ead79b241c791"><div class="ttname"><a href="struct_tile.html#a2ca01a9c0594b163f81ead79b241c791">Tile::TileCount</a></div><div class="ttdeci">byte TileCount</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00003">equinoxe-flightengine.h:3</a></div></div>
<div class="ttc" id="astruct_tile_html_a482a11a586796bef6b769f08b90fedef"><div class="ttname"><a href="struct_tile.html#a482a11a586796bef6b769f08b90fedef">Tile::PaletteOffset</a></div><div class="ttdeci">byte PaletteOffset</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00007">equinoxe-flightengine.h:7</a></div></div>
<div class="ttc" id="astruct_tile_html_aaa4603c4efa12f735b2357f981580871"><div class="ttname"><a href="struct_tile.html#aaa4603c4efa12f735b2357f981580871">Tile::BRAM_Handle</a></div><div class="ttdeci">heap_handle BRAM_Handle</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00009">equinoxe-floorengine.h:9</a></div></div>
<div class="ttc" id="astruct_tile_html_aeb95ad7b79fb1204901a4b9f78f7d587"><div class="ttname"><a href="struct_tile.html#aeb95ad7b79fb1204901a4b9f78f7d587">Tile::TileOffset</a></div><div class="ttdeci">byte TileOffset</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00004">equinoxe-flightengine.h:4</a></div></div>
<div class="ttc" id="astruct_tile_html_af4424f0d3af5275819bc38a858ffc972"><div class="ttname"><a href="struct_tile.html#af4424f0d3af5275819bc38a858ffc972">Tile::File</a></div><div class="ttdeci">char File[16]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00002">equinoxe-flightengine.h:2</a></div></div>
<div class="ttc" id="astruct_tile_html_afc1da51547d9f1bb7115d9983886714b"><div class="ttname"><a href="struct_tile.html#afc1da51547d9f1bb7115d9983886714b">Tile::TileSize</a></div><div class="ttdeci">word TileSize</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-flightengine_8h_source.html#l00006">equinoxe-flightengine.h:6</a></div></div>
<div class="ttc" id="astruct_tile_part_html"><div class="ttname"><a href="struct_tile_part.html">TilePart</a></div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00029">equinoxe-floorengine.h:29</a></div></div>
<div class="ttc" id="astruct_tile_part_html_a902dcaa01f301b20ed0aae61a2ff7dad"><div class="ttname"><a href="struct_tile_part.html#a902dcaa01f301b20ed0aae61a2ff7dad">TilePart::TileOffset</a></div><div class="ttdeci">word TileOffset</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00031">equinoxe-floorengine.h:31</a></div></div>
<div class="ttc" id="astruct_tile_part_html_ab458bd74036a8b7ef8d10ffa2ca1b0a5"><div class="ttname"><a href="struct_tile_part.html#ab458bd74036a8b7ef8d10ffa2ca1b0a5">TilePart::VRAM_Handle</a></div><div class="ttdeci">heap_handle VRAM_Handle</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00032">equinoxe-floorengine.h:32</a></div></div>
<div class="ttc" id="astruct_tile_part_html_abdcf78667571450be54abc47cdb70421"><div class="ttname"><a href="struct_tile_part.html#abdcf78667571450be54abc47cdb70421">TilePart::Tile</a></div><div class="ttdeci">struct Tile * Tile</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00030">equinoxe-floorengine.h:30</a></div></div>
<div class="ttc" id="astruct_tile_segment_html"><div class="ttname"><a href="struct_tile_segment.html">TileSegment</a></div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00182">equinoxe-floorengine.h:182</a></div></div>
<div class="ttc" id="astruct_tile_segment_html_a36fc07394826b7d1c6c9b9dd05084814"><div class="ttname"><a href="struct_tile_segment.html#a36fc07394826b7d1c6c9b9dd05084814">TileSegment::Glue</a></div><div class="ttdeci">struct TileGlue * Glue[4]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00185">equinoxe-floorengine.h:185</a></div></div>
<div class="ttc" id="astruct_tile_segment_html_a370f45ef2d9e85374fb152087e171d43"><div class="ttname"><a href="struct_tile_segment.html#a370f45ef2d9e85374fb152087e171d43">TileSegment::Composition</a></div><div class="ttdeci">byte Composition[4]</div><div class="ttdef"><b>Definition:</b> <a href="equinoxe-floorengine_8h_source.html#l00184">equinoxe-floorengine.h:184</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
